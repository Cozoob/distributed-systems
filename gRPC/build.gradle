plugins {
    id 'java'
    id("com.pswidersk.python-plugin") version "2.3.0"
    id 'com.google.protobuf' version '0.8.17'
}

group 'com.example'
version '1.0-SNAPSHOT'

repositories {
    maven {
        url = uri("https://plugins.gradle.org/m2/")
    }
    mavenCentral()
    maven { url "https://jitpack.io" }
}

dependencies {
    implementation 'io.grpc:grpc-netty-shaded:1.41.0'
    implementation 'io.grpc:grpc-protobuf:1.41.0'
    implementation 'io.grpc:grpc-stub:1.41.0'
    implementation 'com.google.protobuf:protobuf-java:3.18.1'
    implementation 'io.grpc:grpc-services:1.41.0'
    implementation 'javax.annotation:javax.annotation-api:1.3.2'

    implementation "com.pswidersk:python-gradle-plugin:2.3.0"
}

sourceSets {
    main {
        java {
            srcDirs = ['src', 'gen']
        }
    }
}

compileJava {
    options.encoding = "UTF-8"
}

pythonPlugin {
    pythonVersion.set("3.8.2")
}

exec {
    workingDir System.getProperty("user.dir")
    commandLine 'python', '-m', 'virtualenv', 'env'
    commandLine 'cmd','activate','env','&&','pip','install','pybuilder'
}